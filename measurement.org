#+TITLE: Tikz - Measurements
:DRAWER:
#+STARTUP: overview

#+LANGUAGE: en
#+EMAIL: dehaeze.thomas@gmail.com
#+AUTHOR: Dehaeze Thomas

#+HTML_LINK_HOME: ./index.html
#+HTML_LINK_UP: ./index.html

#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="./css/htmlize.css"/>
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="./css/readtheorg.css"/>
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="./css/zenburn.css"/>
#+HTML_HEAD: <script type="text/javascript" src="./js/jquery.min.js"></script>
#+HTML_HEAD: <script type="text/javascript" src="./js/bootstrap.min.js"></script>
#+HTML_HEAD: <script type="text/javascript" src="./js/jquery.stickytableheaders.min.js"></script>
#+HTML_HEAD: <script type="text/javascript" src="./js/readtheorg.js"></script>

#+HTML_MATHJAX: align: center tagside: right font: TeX

#+PROPERTY: header-args:latex  :headers '("\\usepackage{tikz}" "\\usepackage{import}" "\\import{$HOME/MEGA/These/LaTeX/}{config.tex}")
#+PROPERTY: header-args:latex+ :imagemagick t :fit yes
#+PROPERTY: header-args:latex+ :iminoptions -scale 100% -density 150
#+PROPERTY: header-args:latex+ :imoutoptions -quality 100
#+PROPERTY: header-args:latex+ :results raw replace :buffer no
#+PROPERTY: header-args:latex+ :eval no-export
#+PROPERTY: header-args:latex+ :exports both
#+PROPERTY: header-args:latex+ :mkdirp yes
#+PROPERTY: header-args:latex+ :output-dir figs
#+PROPERTY: header-args:latex+ :post pdf2svg(file=*this*, ext="png")
:END:

* Modal Test
** Diagram for modal test
#+begin_src latex :file modal_test_procedure.pdf
  \begin{tikzpicture}
    \tikzset{mylabel/.style={anchor=north, above, font=\bfseries\small, color=black, text width=3cm, align=center}};
    \tikzset{mystep/.style={block, align=center, text width=3cm, minimum height=2cm}};
    \tikzset{myaction/.style={midway, align=center, text width=3cm, font=\small}};
    \tikzset{myverif/.style={draw, fill=white, align=center, text width=3cm, font=\small, minimum height=2cm}};

    \node[mystep, label={[mylabel] FRF Matrix}] (frf) at (0, 0){$3\times69\times801$\\exc $\times$ meas $\times$ freq};
    \node[mystep, label={[mylabel] Modal Model}, right=3 of frf] (modalmodel){$[\Omega]_{N\times N} \quad [\Psi]_{M\times N}$\\$N = 21 \quad M = 69$\\modes, DOFs};
    \node[mystep, label={[mylabel] Solid Body Modal Model}, right=3 of modalmodel] (sbmodalmodel){$[\Omega]_{N\times N} \quad [\Psi]_{M^\prime\times N}$\\$N = 21 \quad M^\prime = 36$\\modes, DOFs};
    \node[mystep, label={[mylabel] Reduced Modal Model}, right=3 of sbmodalmodel] (rmodalmodel){$[\Omega]_{N\times N} \quad [\Psi]_{N \times N}$\\$N = 21$};
    \node[mystep, label={[mylabel] Spatial Model}, right=3 of rmodalmodel] (spatialmodel){$[M] \quad [C] \quad [K]$\\$N \times N$ matrices};
    \node[mystep, label={[mylabel] Multi Body Model}, right=3 of spatialmodel] (multibodymodel){};

    \draw[->] ($(frf.west)+(-3, 0)$) --node[midway, above]{measurements} (frf.west);
    \draw[->] (frf.east) --node[midway, above]{modal analysis} (modalmodel.west);
    \draw[->] (modalmodel.east) --node[myaction, above]{solid body assumption}node[myaction, below]{change of coordinates} (sbmodalmodel.west);
    \draw[->] (sbmodalmodel.east) --node[myaction, above]{reduction of DOFs}node[myaction, below]{to match number of modes} (rmodalmodel.west);
    \draw[->] (rmodalmodel.east) -- (spatialmodel.west);
    \draw[->] (spatialmodel.east) -- (multibodymodel.west);

    \draw[->, dashed] (modalmodel.north west)  to[out=135, in=45]coordinate[midway, above=0.2](frfsynthesis) (frf.north east);
    \draw[->, dashed] (sbmodalmodel.north west) to[out=135, in=45]coordinate[midway, above=0.2](frfsynacc)   (modalmodel.north east);
    \draw[->, dashed] (rmodalmodel.north west)  to[out=135, in=45]coordinate[midway, above=0.2](comac)       (sbmodalmodel.north east);

    \node[myverif, anchor=south] at (frfsynthesis){FRF Synthesis};
    \node[myverif, anchor=south] at (frfsynacc){FRF synthesis at the location of the accelerometers};
    \node[myverif, anchor=south] at (comac){COMAC};
  \end{tikzpicture}
#+end_src

#+RESULTS:
[[file:figs/modal_test_procedure.png]]
** Diagram for modal test
#+begin_src latex :file modal_test_procedure_vertical.pdf
  \begin{tikzpicture}
    % Styles
    \tikzset{mystep/.style=  {draw, fill=white,          text width=3cm, align=center, minimum height=2cm}};
    \tikzset{myaction/.style={draw, fill=blue!30!white,  text width=4cm, align=center,  font=\small, anchor=east, right=0.5, minimum height=2cm}};
    \tikzset{myverif/.style= {draw, fill=green!30!white, text width=4cm, aligncenterht, font=\small, anchor=west, left=0.5,  minimum height=2cm}};
    \tikzset{mylabel/.style= {anchor=north, below, font=\bfseries\small, color=black, text width=3cm, align=center}};
    \tikzset{mymodel/.style= {anchor=south, above, font=\small, color=black, text width=3cm, align=center}};

    % Models
    \node[mystep, label={[mylabel] Physical System}] (physicalsys) at (0, 0){};
    \node[mystep, label={[mylabel] FRF Matrix},             below=1 of physicalsys]  (frf)           {};
    \node[mystep, label={[mylabel] Modal Model},            below=1 of frf]          (modalmodel)    {};
    \node[mystep, label={[mylabel] Solid Body Modal Model}, below=1 of modalmodel]   (sbmodalmodel)  {};
    \node[mystep, label={[mylabel] Reduced Modal Model},    below=1 of sbmodalmodel] (rmodalmodel)   {};
    \node[mystep, label={[mylabel] Spatial Model},          below=1 of rmodalmodel]  (spatialmodel)  {};
    \node[mystep, label={[mylabel] Multi Body Model},       below=1 of spatialmodel] (multibodymodel){};

    % Model Description
    \node[mymodel] at (frf.south)            {$\begin{aligned} &[H(\omega_i)]_{s \times (3 \times m)} \\ &\omega_i,\ i=1\ \dots\ q \end{aligned}$};
    \node[mymodel] at (modalmodel.south)     {$\begin{aligned} &[\Lambda]_{n \times n} \\ &[\Psi]_{(3 \times m) \times n} \end{aligned}$};
    \node[mymodel] at (sbmodalmodel.south)   {$\begin{aligned} &[\Lambda]_{n \times n} \\ &[\Psi^\prime]_{(6 \times p) \times n} \end{aligned}$};
    \node[mymodel] at (rmodalmodel.south)    {$\begin{aligned} &[\Lambda]_{n \times n} \\ &[\Psi^\prime]_{n \times n} \end{aligned}$};
    \node[mymodel] at (spatialmodel.south)   {$\begin{aligned} &[M]_{n \times n} \quad [C]_{n \times n} \\ &[K]_{n \times n} \end{aligned}$};
    \node[mymodel] at (multibodymodel.south) {};

    % Steps: From one model to the other: Arrows
    \draw[->, dashed] (physicalsys.-10)   to[out=-10, in=10 ] (frf.10);
    \draw[->, dashed] (frf.-10)           to[out=-10, in=10 ] (modalmodel.10);
    \draw[->, dashed] (modalmodel.-10)    to[out=-10, in=10 ] (sbmodalmodel.10);
    \draw[->, dashed] (sbmodalmodel.-10)  to[out=-10, in=10 ] (rmodalmodel.10);
    \draw[->, dashed] (rmodalmodel.-10)   to[out=-10, in=10 ] (spatialmodel.10);

    % Verification Steps Arrows
    \draw[->, dashed] (modalmodel.170)    to[out=170, in=190] (frf.190);
    \draw[->, dashed] (sbmodalmodel.170)  to[out=170, in=190] (modalmodel.190);
    \draw[->, dashed] (rmodalmodel.170)   to[out=170, in=190] (sbmodalmodel.190);
    \draw[->, dashed] (spatialmodel.170)  to[out=170, in=190] (rmodalmodel.190);

    % Steps - Details
    \node[myaction, label={[mylabel] Measurements}] (measurement)                      at ($(physicalsys.south east)!0.5!(frf.north east)$) {};
    \node[myaction, label={[mylabel] Modal Analysis}] (modalanalysis)                  at ($(frf.south east)!0.5!(modalmodel.north east)$) {};
    \node[myaction, label={[mylabel] Solid Body Assumption}] (sbassumption)            at ($(modalmodel.south east)!0.5!(sbmodalmodel.north east)$) {};
    \node[myaction, label={[mylabel] Model Order Reduction}] (orderreduction)          at ($(sbmodalmodel.south east)!0.5!(rmodalmodel.north east)$) {};
    \node[myaction, label={[mylabel] Spatial Matrices Extraction}] (spatialextraction) at ($(rmodalmodel.south east)!0.5!(spatialmodel.north east)$) {};

    % Verification steps - Details
    \node[myverif, label={[mylabel] FRF Synthesis}] (frfsynthesis) at ($(frf.south west)!0.5!(modalmodel.north west)$) {};
    \node[myverif, label={[mylabel] Acc. FRF Synthesis}] (synthesisacc) at ($(modalmodel.south west)!0.5!(sbmodalmodel.north west)$) {};
    \node[myverif, label={[mylabel] COMAC}] (comac)        at ($(sbmodalmodel.south west)!0.5!(rmodalmodel.north west)$) {};
    \node[myverif, label={[mylabel] Modal Decomposition}] (modaldecomp)  at ($(rmodalmodel.south west)!0.5!(spatialmodel.north west)$) {};
  \end{tikzpicture}
#+end_src

#+RESULTS:
[[file:figs/modal_test_procedure_vertical.png]]
